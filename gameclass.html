<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Gamedev Canvas Workshop</title>
    <style>
    	* { padding: 0; margin: 0; }
    	canvas { background: #eee; display: block; margin: 0 auto; }
    </style>
</head>
<body>

<canvas id="myCanvas" width="480" height="320"></canvas>

<script>
	var canvas = document.getElementById("myCanvas");
    var ctx = canvas.getContext("2d");
    var rightPressed = false;
    var leftPressed = false;
    
    document.addEventListener("keydown", keyDownHandler, false);
    document.addEventListener("keyup", keyUpHandler, false);

    function reloadPage(){
    location.reload();
    }
    function keyDownHandler(e) {
        if(e.key == "Right" || e.key == "ArrowRight") {
        rightPressed = true;
    }
    else if(e.key == "Left" || e.key == "ArrowLeft") {
        leftPressed = true;
    }
    }

    function keyUpHandler(e) {
    if(e.key == "Right" || e.key == "ArrowRight") {
        rightPressed = false;
    }
    else if(e.key == "Left" || e.key == "ArrowLeft") {
        leftPressed = false;
    }
    }
    class BreakoutGame {
            draw() {
                myBall.draw();
                myPad.draw();
                myBrick.draw();
                myBall.bouceBall();
                myPad.move();
                myBall.move();
                myPad.hitPaddle();
                myBrick.hitBrick();
                myBrick.winCheck();
            }
            update() {
                ctx.font = "16px Arial";
                ctx.fillStyle = "#0095DD";
                ctx.fillText("Score: " + myBrick.brickScore, 8, 20);
                
            }
        }
    class Ball{
    
        constructor(posX,posY,width){
            this.posX=posX;
            this.posY=posY;
            this.width=width;
            this.dx=2;
            this.dy=-2;
            }      
        get speedy()
        {
            return this.dy;
        }
        set speedy(y)
        {
            this.dy=y;
        }
        get widthball()
        {
            return this.width
        }
        get positionx()
        {
            return this.posX;
        }
        get positiony()
        {
            return this.posY;
        }
        draw()
            {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.beginPath();
            ctx.arc(this.posX ,this.posY,this.width,0,Math.PI*2);
            ctx.fillStyle = "#0095DD";
            ctx.fill();
            ctx.closePath();
            }
        move()
            {
            this.posX =this.posX+this.dx;
            this.posY =this.posY+this.dy;    
            }
        bouceBall()
            {
            if(this.posX + this.dx > canvas.width-this.width || this.posX + this.dx < this.width) {
                this.dx = -this.dx;
            }
            if(this.posY + this.dy < this.width) {
                this.dy = -this.dy;
            }
            }
        }
    class Paddle{
        constructor(paddleX,paddleHeight,paddleWidth){
            this.paddleX=paddleX
            this.paddleHeight=paddleHeight
            this.paddleWidth=paddleWidth
        }
        
        draw()
        {
            ctx.beginPath();
            ctx.rect(this.paddleX, canvas.height-this.paddleHeight, this.paddleWidth, this.paddleHeight);
            ctx.fillStyle = "#0095DD";
            ctx.fill();
            ctx.closePath();
        }
        move()
        {
            if(rightPressed) {
            this.paddleX += 7;
            if (this.paddleX + this.paddleWidth > canvas.width){
                this.paddleX = canvas.width - this.paddleWidth;
            }
            }
            else if(leftPressed) {
            this.paddleX -= 7;
            if (this.paddleX < 0){
                this.paddleX = 0;
            }
        }
        }
        hitPaddle()
        {
            if(myBall.positiony+myBall.speedy>canvas.height-myBall.widthball)
            {
                if(myBall.positionx > this.paddleX && myBall.positionx < this.paddleX + this.paddleWidth) {
                    myBall.speedy = -myBall.speedy;
                    }
                else
                {
                    
                    window.location.reload();
                    alert("Game Over")
                }
        }
    }
}

class Brick{
        constructor(brickRow,brickColumn){
            this.brickRow=brickRow
            this.brickColumn=brickColumn
            this.brickWidth=75
            this.brickHeight=20
            this.brickPadding=10;
            this.brickoffsetTop=30;
            this.brickoffsetLeft=30;
            this.brickX;
            this.brickY;
            this.brickScore=0;
            this.bricks=[]
            for(var c=0;c<this.brickColumn;c++) {
                this.bricks[c] = [];
                for(var r=0;r<this.brickRow;r++) {
                this.bricks[c][r] = {x:0,y:0,status:1};
            }
        }
        }
        draw()
        {
            for(var c=0;c<this.brickColumn;c++){
                for(var r=0;r<this.brickRow;r++){
                    if (this.bricks[c][r].status == 1) {
                    this.brickX = (c*(this.brickWidth+this.brickPadding))+this.brickoffsetLeft;
                    this.brickY = (r*(this.brickHeight+this.brickPadding))+this.brickoffsetTop;
                    this.bricks[c][r].x = this.brickX;
                    this.bricks[c][r].y = this.brickY;
                    ctx.beginPath();
                    ctx.rect(this.brickX, this.brickY, this.brickWidth, this.brickHeight);
                    ctx.fillStyle = "#0095DD";
                    ctx.fill();
                    ctx.closePath();
                    }
                }
            }
        }
        hitBrick()
        {
            for (var c= 0; c < this.brickColumn; c++) {
                for (var r = 0; r < this.brickRow; r++) {
            
            if (this.bricks[c][r].status == 1) {
                if (myBall.positionx > this.bricks[c][r].x && myBall.positionx < this.bricks[c][r].x + this.brickWidth 
                && myBall.positiony > this.bricks[c][r].y &&myBall.positiony < this.bricks[c][r].y + this.brickHeight) {
                    myBall.speedy = -myBall.speedy;
                    this.bricks[c][r].status = 0;
                    this.brickScore=this.brickScore+1;
                }
            }
        }
    }
        }
    
        winCheck()
        {
            
            if(this.brickScore==this.brickRow*this.brickColumn){
                window.location.reload();
                alert("You are the Winner")
            }
        }
    }   

function start() {
    game.draw();
    game.update();
    requestAnimationFrame(start)

}
let game = new  BreakoutGame;
let myBall=new Ball(canvas.width/2,canvas.height-30,10) 
let myPad=new Paddle((canvas.width-75)/2,10,75)
let myBrick=new Brick(3,5)
start();
</script>

</body>
</html>
