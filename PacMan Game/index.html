<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
    <title>PAC-MAN</title>
    <link rel="stylesheet" href="index.css">
</head>
<body>

<h1>PAC-MAN Game</h1>
<canvas id="canvas" width="800" height="400"></canvas>

<script>
    class Pacman
    {
        constructor(posX,posY,width)
        {
            this.canvas = document.getElementById("canvas");
            this.ctx = this.canvas.getContext("2d");
            this.posX = posX;
            this.posY = posY;
            this.width = width;
            this.speed;
        }

        draw()
        {
            this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
            this.ctx.beginPath();
            this.ctx.arc(this.posX ,this.posY,this.width,0,Math.PI*2);
            this.ctx.fillStyle = 'yellow';
            this.ctx.fill();
            this.ctx.closePath();
        }

        moveLeft()
        {
            this.posX -= 62;
            if (this.posX-this.width < 0) // when paddle over the border left of canvas
            {
                this.posX = 32; // set paddle at left
            }
        }

        moveRight()
        {
            this.posX += 62;
            if (this.posX + (this.width+5) > this.canvas.width) // when paddle over the border right of canvas
            {
                this.posX = this.canvas.width - (this.width+9); // set paddle at right
            }
        }

        moveUp()
        {
            this.posY -= 62;
            if (this.posY-(this.width+30) < 0) // when paddle over the border left of canvas
            {
                this.posY = 60; // set paddle at left
            }
        }

        moveDown()
        {
            this.posY += 62;
            if (this.posY + (this.width+5) > this.canvas.height) // when paddle over the border right of canvas
            {
                this.posY = this.canvas.height-30 // set paddle at right
            }
        }
    }

    class Ghost
    {
        constructor()
        {
            this.canvas = document.getElementById("canvas");
            this.ctx = this.canvas.getContext("2d");
            this.posX;
            this.posY;
            this.width;
            this.speed;
        }

        draw()
        {

        }

        move()
        {

        }

        hitPacman(x, y)
        {

        }
    }

    class Food
    {
        constructor()
        {
            this.canvas = document.getElementById("canvas");
            this.ctx = this.canvas.getContext("2d");
            this.width = 10
            this.height = 10
            this.row = 6
            this.column = 13
            this.padding = 52;
            this.offsetTop = 56;
            this.offsetLeft = 26;
            this.posX ;
            this.posY ;

            // create foods
            this.foods = [];
            for(var c=0;c<this.column;c++)
            {
                this.foods[c] = [];
                for(var r=0; r<this.row; r++) 
                {
                    this.foods[c][r] = {x:0, y:0, status:1};
                }
            }
        }

        draw()
        {
            for(var c=0; c<this.column; c++)
            {
                for(var r=0; r<this.row; r++)
                {
                    if (this.foods[c][r].status == 1)  // if bricks remain
                    {
                        this.X = (c*(this.width+this.padding))+this.offsetLeft;
                        this.Y = (r*(this.height+this.padding))+this.offsetTop;
                        this.foods[c][r].x = this.X;
                        this.foods[c][r].y = this.Y;
                        this.ctx.beginPath();
                        this.ctx.rect(this.X, this.Y, this.width, this.height);
                        this.ctx.fillStyle = "white";
                        this.ctx.fill();
                        this.ctx.closePath();
                    }
                }
            }
        }

        eated(posX,posY)
        {
            for (var c= 0; c < this.column; c++)
            {
                for (var r = 0; r < this.row; r++) 
                {
                    if (this.foods[c][r].status == 1)
                    {
                        if (posX > this.foods[c][r].x && posX < this.foods[c][r].x + this.width
                        && posY > this.foods[c][r].y && posY < this.foods[c][r].y + this.height) 
                        {
                            this.foods[c][r].status = 0;
                            return true;
                        }
                    }
                }
            }
            return false;
        }
    }

    class Wall
    {
        constructor()
        {
            this.canvas = document.getElementById("canvas");
            this.ctx = this.canvas.getContext("2d");
            this.row = 2
            this.column = 3
            this.width = 248
            this.height = 124
            this.padding = 62;
            this.offsetTop = 30;
            this.posX;
            this.posY;
            this.walls = []
            for(var c=0;c<this.column;c++)
            {
                this.walls[c] = [];
                for(var r=0; r<this.row; r++) 
                {
                    this.walls[c][r] = {x:0, y:0};
                }
            }
        }
        draw()
        {
            for(var c=0; c<this.column; c++)
            {
                for(var r=0; r<this.row; r++)
                {
                    
                        this.wx = (c*(this.width+this.padding));
                        this.wy = (r*(this.height+this.padding)+this.offsetTop);
                        this.walls[c][r].x = this.wx;
                        this.walls[c][r].y = this.wy;
                        this.ctx.beginPath();
                        this.ctx.rect(this.wx, this.wy, this.width, this.height);
                        this.ctx.fillStyle = "green";
                        this.ctx.fill();
                        this.ctx.closePath();
                    
                }
            }
        }

        hitWall(x, y)
        {

        }
    }

    class InputProcessor
    {
        addEvent()
        {
            document.addEventListener("keydown", this.keyDownHandler, false);
            document.addEventListener("mousemove", this.mouseMoveHandler, false);
        }

        keyDownHandler(e) 
        {
            if (e.key == "d" || e.key == "ArrowRight" || e.key == "Right")
            {
                game.pacMan.moveRight();
            }
            else if (e.key == "a" || e.key == "ArrowLeft" || e.key == "Left")
            {
                game.pacMan.moveLeft();
            }
            else if (e.key == "w" || e.key == "ArrowUp")
            {
                game.pacMan.moveUp();
            }
            else if (e.key == "s" || e.key == "ArrowDown")
            {
                game.pacMan.moveDown();
            }
        }

        mouseMoveHandler(e)
        {

        }
    }

    class Game
    {
        constructor()
        {
            this.canvas = document.getElementById("canvas");
            this.ctx = this.canvas.getContext("2d");
            this.lives = 3;
            this.score = 0;
            this.pacMan = new Pacman((this.canvas.width/2)+4, this.canvas.height-30, 15);
            this.wall = new Wall();
            this.ghost = new Ghost();
            this.food = new Food();
            this.inputProcessor = new InputProcessor();
            this.inputProcessor.addEvent();
        }

        draw()
        {
            this.pacMan.draw();
            this.food.draw();
            this.wall.draw();
            this.collisionDetection();
            this.updateGame();
            requestAnimationFrame(()=>this.draw());
        }

        updateGame()
        {
            this.ctx.font = "16px Arial";
            this.ctx.fillStyle = "white";
            this.ctx.fillText("Score: " + this.score, 8, 20);
            this.ctx.fillText("Lives: "+ this.lives, this.canvas.width-65, 20);
        }

        collisionDetection()
        {
            if (this.food.eated(this.pacMan.posX, this.pacMan.posY))
            {
                this.score += 1;
            }
        }
    }

let game = new Game();
game.draw();
</script>
</body>
</html>